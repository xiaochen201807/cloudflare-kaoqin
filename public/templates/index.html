<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>考勤打卡系统</title>
    <!-- 高德地图安全配置 -->
    <script type="text/javascript">
        window._AMapSecurityConfig = {
            securityJsCode: "{{AMAP_SECURITY_CODE}}", 
            serviceHost: '/_AMapService'
        };
    </script>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=2.0&key={{AMAP_KEY}}&plugin=AMap.PlaceSearch,AMap.ToolBar,AMap.Scale,AMap.Geocoder,AMap.Geolocation"></script>
    <link rel="stylesheet" href="/css/index.css">
</head>
<body>
    <div class="main-container">
        <!-- 地图容器 -->
        <div class="map-container">
            <div id="mapContainer"></div>
        </div>

        <!-- 右侧打卡面板 -->
        <div class="checkin-panel">
            <!-- 面板头部 -->
            <div class="panel-header">
                <h1>📍 考勤打卡</h1>
                <div class="user-name" id="userDisplayName">加载中...</div>
            </div>

            <!-- 搜索区域 -->
            <div class="search-section">
                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="搜索地点..." />
                    <button class="search-btn" onclick="searchLocation()">🔍</button>
                </div>

                <!-- 当前位置坐标显示 -->
                <div class="coord-section">
                    <div class="section-title">
                        📍 当前位置坐标
                        <button class="clear-btn" onclick="getCurrentCoordinates()" title="获取当前位置">定位</button>
                    </div>
                    <div class="current-coords" id="currentCoords">
                        <small>请先搜索位置或获取当前位置</small>
                    </div>
                </div>

                <!-- 搜索历史 -->
                <div class="history-section">
                    <div class="section-title">
                        🕒 搜索历史
                        <button class="clear-btn" onclick="clearHistory()">清空</button>
                    </div>
                    <div class="history-list" id="historyList">
                        <div style="padding: 20px; text-align: center; color: #999; font-size: 0.8em;">暂无搜索历史</div>
                    </div>
                </div>

                <!-- 收藏地点 -->
                <div class="history-section">
                    <div class="section-title">
                        ⭐ 收藏地点
                        <button class="clear-btn" onclick="clearFavorites()">清空</button>
                    </div>
                    <div class="favorite-list" id="favoriteList">
                        <div style="padding: 20px; text-align: center; color: #999; font-size: 0.8em;">暂无收藏地点</div>
                    </div>
                </div>
            </div>

            <!-- 面板内容 -->
            <div class="panel-content">
                <div id="statusMessage"></div>

                <div class="location-info" id="locationInfo">
                    <h4>📍 当前位置</h4>
                    <p id="locationAddress">正在获取位置信息...</p>
                    <p class="coordinates" id="locationCoords">坐标: --</p>
                    <button class="action-btn favorite-btn" id="favoriteCurrentBtn" onclick="favoriteCurrentLocation()" title="收藏当前位置">
                        ⭐ 收藏
                    </button>
                </div>

                <div class="name-input">
                    <label for="realName">真实姓名:</label>
                    <input type="text" id="realName" name="realName" placeholder="请输入您的真实姓名" required>
                </div>

                <button class="btn btn-secondary" id="refreshLocationBtn" onclick="refreshLocation()">
                    🔄 刷新位置
                </button>

                <button class="btn btn-primary" id="submitLocationBtn" onclick="submitLocation()" disabled>
                    ✅ 提交打卡
                </button>
            </div>

            <!-- 面板底部 -->
            <div class="panel-footer">
                <button class="logout-btn" onclick="logout()">退出登录</button>
            </div>
        </div>
    </div>

    <script src="/js/map.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/main.js"></script>
</body>
</html>
